<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Finding Missing Groups · GCIdentifier.jl</title><meta name="title" content="Finding Missing Groups · GCIdentifier.jl"/><meta property="og:title" content="Finding Missing Groups · GCIdentifier.jl"/><meta property="twitter:title" content="Finding Missing Groups · GCIdentifier.jl"/><meta name="description" content="Documentation for GCIdentifier.jl."/><meta property="og:description" content="Documentation for GCIdentifier.jl."/><meta property="twitter:description" content="Documentation for GCIdentifier.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/GCIdentifier.jl/missing_groups/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/GCIdentifier.jl/missing_groups/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/GCIdentifier.jl/missing_groups/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GCIdentifier.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../group_search/">Group Assignment</a></li><li class="is-active"><a class="tocitem" href>Finding Missing Groups</a><ul class="internal"><li><a class="tocitem" href="#Automatically-fragment-a-molecule"><span>Automatically fragment a molecule</span></a></li></ul></li><li><a class="tocitem" href="../custom_groups/">Custom Groups</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Finding Missing Groups</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Finding Missing Groups</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/GCIdentifier.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/GCIdentifier.jl/blob/main/docs/src/missing_groups.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Find-Missing-Groups"><a class="docs-heading-anchor" href="#Find-Missing-Groups">Find Missing Groups</a><a id="Find-Missing-Groups-1"></a><a class="docs-heading-anchor-permalink" href="#Find-Missing-Groups" title="Permalink"></a></h1><p>In some cases, our group contribution method will not have every group needed to cover every atom within a molecule. The example we gave previously was how SAFT-<span>$\gamma$</span> Mie lacked a group for ketones:</p><pre><code class="language-julia hljs">julia&gt; (smiles,groups) = get_groups_from_smiles(&quot;CCC(=O)CC&quot;, SAFTgammaMieGroups)
ERROR: Could not find all groups for CCC(=O)CC</code></pre><p>In this case, it could be possible that GCIdentifier simply hasn&#39;t included the missing group within our database or perhaps that group needs to be parameterised. To find out which groups might help fill-in the missing atoms, one can use <code>find_missing_groups_from_smiles</code>:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;CCC(=O)CC&quot;, SAFTgammaMieGroups)
3-element Vector{GCPair}:
 GCPair(&quot;[CX3;H0;!R]&quot;, &quot;C=&quot;)
 GCPair(&quot;[OX1;H0;!R]&quot;, &quot;O=&quot;)
 GCPair(&quot;[CX3;H0;!R](=[OX1;H0;!R])&quot;, &quot;C=O=&quot;)</code></pre><p>where <code>groups</code> is a vector of <code>GCPair</code>s with proposed names of the groups. As we can see, GCIdentifier has proposed three potential groups, where the last is a combination of the first two. From this list, the users can decide which group might be best to parameterise. However, we also have our own <a href="../api/">internal heuristics</a> for proposing a <em>minimal</em> group representation of molecules within GCIdentifier which will reduce this list to what we recommend:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;CCC(=O)CC&quot;, SAFTgammaMieGroups; reduced=true)
1-element Vector{GCPair}:
 GCPair(&quot;[CX3;H0;!R](=[OX1;H0;!R])&quot;, &quot;C=O=&quot;)</code></pre><p>In the case of the ketone, we would only really want to parameterise this group.</p><h2 id="Automatically-fragment-a-molecule"><a class="docs-heading-anchor" href="#Automatically-fragment-a-molecule">Automatically fragment a molecule</a><a id="Automatically-fragment-a-molecule-1"></a><a class="docs-heading-anchor-permalink" href="#Automatically-fragment-a-molecule" title="Permalink"></a></h2><p>Let us now consider an extreme case where we are trying to fragment a molecule into groups with no reference group-contribution approach. In the case of our ketone, the code will fragment the molecule into atomic groups, along with combinations of those atomic groups:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;CCCC(=O)CCC&quot;)
5-element Vector{GCPair}:
 GCPair(&quot;[CX4;H3;!R]&quot;, &quot;CH3&quot;)
 GCPair(&quot;[CX4;H2;!R]&quot;, &quot;CH2&quot;)
 GCPair(&quot;[CX3;H0;!R]&quot;, &quot;C=&quot;)
 GCPair(&quot;[OX1;H0;!R]&quot;, &quot;O=&quot;)
 GCPair(&quot;[CX3;H0;!R](=[OX1;H0;!R])&quot;, &quot;C=O=&quot;)

julia&gt; groups = find_missing_groups_from_smiles(&quot;CCCC(=O)CCC&quot;; reduced=true)
3-element Vector{GCPair}:
 GCPair(&quot;[CX4;H3;!R]&quot;, &quot;CH3&quot;)
 GCPair(&quot;[CX4;H2;!R]&quot;, &quot;CH2&quot;)
 GCPair(&quot;[CX3;H0;!R](=[OX1;H0;!R])&quot;, &quot;C=O=&quot;)</code></pre><p>As we can see, GCIdentifier proposes all the groups that one requires to represent this ketone. However, one aspect of this fragmentation that users may care about is that the methylene (CH<span>$_2$</span>) groups bonded to the ketone group versus those bonded to the methyl group could technically be treated different, due to the difference in environment within which they exist. This distinction can be made by adding the <code>environment=true</code> optional argument:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;CCCC(=O)CCC&quot;; reduced=true, environment=true)
6-element Vector{GCPair}:
 GCPair(&quot;[CX4;H3;!R;$([CX4;H3;!R]([CX4;H2;!R]))]&quot;, &quot;CH3(CH2)&quot;)
 GCPair(&quot;[CX4;H2;!R;$([CX4;H2;!R]([CX4;H3;!R])([CX4;H2;!R]))]&quot;, &quot;CH2(CH3CH2)&quot;)
 GCPair(&quot;[CX4;H2;!R;$([CX4;H2;!R]([CX4;H2;!R])([CX3;H0;!R]))]&quot;, &quot;CH2(CH2C=)&quot;)
 GCPair(&quot;[CX3;H0;!R;$([CX3;H0;!R]([CX4;H2;!R])(=[OX1;H0;!R])([CX4;H2;!R]))](=[OX1;H0;!R;$([OX1;H0;!R](=[CX3;H0;!R]))])&quot;, &quot;C=(CH2O=CH2)O=(C=)&quot;)
 GCPair(&quot;[CX4;H2;!R;$([CX4;H2;!R]([CX3;H0;!R])([CX4;H2;!R]))]&quot;, &quot;CH2(C=CH2)&quot;)
 GCPair(&quot;[CX4;H2;!R;$([CX4;H2;!R]([CX4;H2;!R])([CX4;H3;!R]))]&quot;, &quot;CH2(CH2CH3)&quot;)</code></pre><p>As we can see in the above, GCIdentifier now proposes many more groups as we now care about the environment within which each group exists. </p><p>One last flexible element of the <code>find_missing_groups_from_smiles</code> function is related to the size of the groups. In all of the above cases, the groups proposed only involve one or two heavy atoms. This is fine for most small molecules. However, for larger ones, such as adenylic acid, the groups proposed may not necessarily be the best representation:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;C1=NC(=C2C(=N1)N(C=N2)C3C(C(C(O3)COP(=O)(O)O)O)O)N&quot;; reduced=true)
12-element Vector{GCPair}:
 GCPair(&quot;[cX3;H1;R][nX2;H0;R]&quot;, &quot;aCHaN&quot;)
 GCPair(&quot;[cX3;H0;R][nX2;H0;R]&quot;, &quot;aCaN&quot;)
 GCPair(&quot;[cX3;H0;R][NX3;H2;!R]&quot;, &quot;aCNH2&quot;)
 GCPair(&quot;[cX3;H0;R][nX3;H0;R]&quot;, &quot;aCaN&quot;)
 GCPair(&quot;[cX3;H1;R][nX3;H0;R]&quot;, &quot;aCHaN&quot;)
 GCPair(&quot;[CX4;H1;R][nX3;H0;R]&quot;, &quot;cCHaN&quot;)
 GCPair(&quot;[CX4;H1;R][OX2;H0;R]&quot;, &quot;cCHcO&quot;)
 GCPair(&quot;[CX4;H1;R][OX2;H1;!R]&quot;, &quot;cCHOH&quot;)
 GCPair(&quot;[CX4;H1;R][CX4;H2;!R]&quot;, &quot;cCHCH2&quot;)
 GCPair(&quot;[OX2;H0;!R]([PX4;H0;!R])&quot;, &quot;OP&quot;)
 GCPair(&quot;[OX1;H0;!R]&quot;, &quot;O=&quot;)
 GCPair(&quot;[OX2;H1;!R]&quot;, &quot;OH&quot;)</code></pre><p>Most groups here are quite reasonable, with the exception of the &quot;O=&quot; and &quot;OH&quot; groups as those will be bonded directly to the phosphorous atom, which we would expect results in very different &quot;O=&quot; and &quot;OH&quot; groups than you&#39;d find on, for example, alcohols. While we could again use the <code>environment</code> capability of GCIdentifier to simply specify the environment in which these groups exist, this will result in far more groups being proposed. Ideally, we would like to combine the phosphate group into one. This can be done by specifying a larger <code>max_group_size</code> in the optional arguments:</p><pre><code class="language-julia hljs">julia&gt; groups = find_missing_groups_from_smiles(&quot;C1=NC(=C2C(=N1)N(C=N2)C3C(C(C(O3)COP(=O)(O)O)O)O)N&quot;; reduced=true, max_group_size=5)
10-element Vector{GCPair}:
 GCPair(&quot;[cX3;H1;R][nX2;H0;R]&quot;, &quot;aCHaN&quot;)
 GCPair(&quot;[cX3;H0;R][nX2;H0;R]&quot;, &quot;aCaN&quot;)
 GCPair(&quot;[cX3;H0;R][NX3;H2;!R]&quot;, &quot;aCNH2&quot;)
 GCPair(&quot;[cX3;H0;R][nX3;H0;R]&quot;, &quot;aCaN&quot;)
 GCPair(&quot;[cX3;H1;R][nX3;H0;R]&quot;, &quot;aCHaN&quot;)
 GCPair(&quot;[CX4;H1;R][nX3;H0;R]&quot;, &quot;cCHaN&quot;)
 GCPair(&quot;[CX4;H1;R][OX2;H0;R]&quot;, &quot;cCHcO&quot;)
 GCPair(&quot;[CX4;H1;R][OX2;H1;!R]&quot;, &quot;cCHOH&quot;)
 GCPair(&quot;[CX4;H1;R][CX4;H2;!R]&quot;, &quot;cCHCH2&quot;)
 GCPair(&quot;[PX4;H0;!R]([OX2;H0;!R])(=[OX1;H0;!R])([OX2;H1;!R])([OX2;H1;!R])&quot;, &quot;POO=OHOH&quot;)</code></pre><p>This is now a very reasonable representation of adenylic acid.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../group_search/">« Group Assignment</a><a class="docs-footer-nextpage" href="../custom_groups/">Custom Groups »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 30 August 2025 01:04">Saturday 30 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
